# Contributor: Filip Wojciechowski, filip at loka dot pl

pkgname=cpuburn
pkgver=1.4
pkgrel=1
pkgdesc="CPU testing utilities in optimized assembler for maximum loading of CPUs"
arch=('i686' 'x86_64')
url="http://pages.sbcglobal.net/redelm/"
license=('GPL')
depends=()
makedepends=('tar') # needs to be extracted manually because of malformed source file name
source=(http://pages.sbcglobal.net/redelm/cpuburn_1_4_tar.gz cpuburn.patch)
noextract=($pkgname_1_4_tar.gz)

build() {
  cd "$srcdir"

  # Workaround for malformed source file name
  mv cpuburn_1_4_tar.gz "$pkgname_$pkgver.tar.gz" || return 1
  tar zxf "$pkgname_$pkgver.tar.gz" || return 1

  cd "$pkgname-$pkgver"
  # a patch from debian/ubuntu patchset
  patch -Np1 -i ../cpuburn.patch || return 1
  make || return 1
  install -Dm755 burnBX $pkgdir/usr/bin/burnBX || return 1
  install -Dm755 burnK6 $pkgdir/usr/bin/burnK6 || return 1
  install -Dm755 burnK7 $pkgdir/usr/bin/burnK7 || return 1
  install -Dm755 burnMMX $pkgdir/usr/bin/burnMMX || return 1
  install -Dm755 burnP5 $pkgdir/usr/bin/burnP5 || return 1
  install -Dm755 burnP6 $pkgdir/usr/bin/burnP6 || return 1
  install -Dm644 README $pkgdir/usr/share/doc/$pkgname/README || return 1
  install -Dm644 Design $pkgdir/usr/share/doc/$pkgname/Design || return 1
}

# vim:set ts=2 sw=2 et:
md5sums=('f9bb5ff68afb6ccfca11718c90bcab68'
         'f3c77db7592ac02ee83958f07ceb8986')
